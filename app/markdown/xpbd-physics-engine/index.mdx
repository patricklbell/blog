Work in progress. See demo page and code for further details.